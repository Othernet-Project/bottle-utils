<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Translation support (bottle_utils.i18n) &mdash; Bottle Utils 0.1a4 documentation</title>
    
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1a4',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Bottle Utils 0.1a4 documentation" href="index.html" />
    <link rel="next" title="Lazy evaluation (bottle_utils.lazy)" href="lazy.html" />
    <link rel="prev" title="HTTP helpers (bottle_utils.http)" href="http.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="lazy.html" title="Lazy evaluation (bottle_utils.lazy)"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="http.html" title="HTTP helpers (bottle_utils.http)"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Bottle Utils 0.1a4 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="translation-support-bottle-utils-i18n">
<h1>Translation support (<code class="docutils literal"><span class="pre">bottle_utils.i18n</span></code>)<a class="headerlink" href="#translation-support-bottle-utils-i18n" title="Permalink to this headline">¶</a></h1>
<div class="section" id="basic-concept">
<h2>Basic concept<a class="headerlink" href="#basic-concept" title="Permalink to this headline">¶</a></h2>
<p>This module provides plugins and functions for translation and language
selection.</p>
<p>Language selection is based on URLs. Each path in the app is augmented with
locale prefix. Therefore, <code class="docutils literal"><span class="pre">/foo/bar/baz</span></code> becomes <code class="docutils literal"><span class="pre">/LOCALE/foo/bar/baz</span></code>
where locale is any of the locales chosen as translation target.</p>
<p>Translation is performed by calling several of the translation functions
provied by this module. These are simple <code class="docutils literal"><span class="pre">gettext()</span></code> and <code class="docutils literal"><span class="pre">ngettext()</span></code>
wrappers that are lazily evaluated with the help of
<a class="reference internal" href="lazy.html#bottle_utils.lazy.Lazy" title="bottle_utils.lazy.Lazy"><code class="xref py py-class docutils literal"><span class="pre">Lazy</span></code></a> class.</p>
<p>This module doesn&#8217;t deal with message extraction or compilation. For this, you
can use the standard <a class="reference external" href="http://www.gnu.org/software/gettext/">GNU Gettext</a> utilities. You can see examples of scripts
that automate this process in scripts used by <a class="reference external" href="https://github.com/Outernet-Project/librarian/">Librarian</a>, <a class="reference external" href="https://github.com/Outernet-Project/librarian/blob/master/scripts/xmsgs.sh">xmsgs.sh</a> and
<a class="reference external" href="https://github.com/Outernet-Project/librarian/blob/master/scripts/cmpmsgs.sh">compmsgs.sh</a>. Detailed description of what these scripts do is outside the
scope of this documentation. However, it&#8217;s worth noting that allowing Gettext
to treat Bottle&#8217;s SimpleTemplate markup as Python code works fine.</p>
</div>
<div class="section" id="setting-up-the-app-for-translation">
<h2>Setting up the app for translation<a class="headerlink" href="#setting-up-the-app-for-translation" title="Permalink to this headline">¶</a></h2>
<p>To activate translations and language selection, you will need to configure the
plugin and middleware.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The plugin class,
<a class="reference internal" href="#bottle_utils.i18n.I18NPlugin" title="bottle_utils.i18n.I18NPlugin"><code class="xref py py-class docutils literal"><span class="pre">I18NPlugin</span></code></a>, is both a Bottle plugin and WSGI
middleware.</p>
</div>
<p>First prepare a list of languages you want to support:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">LANGS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s">&#39;de_DE&#39;</span><span class="p">,</span> <span class="s">&#39;Deutsch&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s">&#39;en_US&#39;</span><span class="p">,</span> <span class="s">&#39;English&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s">&#39;fr_FR&#39;</span><span class="p">,</span> <span class="s">&#39;français&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s">&#39;es_ES&#39;</span><span class="p">,</span> <span class="s">&#39;español&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s">&#39;zh_CN&#39;</span><span class="p">,</span> <span class="s">&#39;中文&#39;</span><span class="p">)</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Also decide which locale you would like to use as default.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">DEFAULT_LOCAL</span> <span class="o">=</span> <span class="s">&#39;en_US&#39;</span>
</pre></div>
</div>
<p>Finally you need to decide where you want to keep the locale directory where
translations are looked up.</p>
<p>The most straightforward way to install the plugin and middleware in one go is
to pass it a bottle application object instead of a pure WSGI app (such as one
returned by other WSGI middleware). There is usually no harm in making this
plugin the first middleware in the stack, so it&#8217;s safe to do so.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">bottle_utils.i18n</span> <span class="kn">import</span> <span class="n">I18NPlugin</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">bottle</span><span class="o">.</span><span class="n">default_app</span><span class="p">()</span>
<span class="n">wsgi_app</span> <span class="o">=</span> <span class="n">I18NPlugin</span><span class="p">(</span><span class="n">app</span><span class="p">,</span> <span class="n">languages</span><span class="o">=</span><span class="n">LANGS</span><span class="p">,</span> <span class="n">default_locale</span><span class="o">=</span><span class="n">DEFAULT_LOCALE</span><span class="p">,</span>
                      <span class="n">locale_dir</span><span class="o">=</span><span class="s">&#39;./locales&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>This installs both the Bottle plugin and the WSGI middleware, and returns a
WSGI application object.</p>
</div>
<div class="section" id="translating-in-python-code">
<h2>Translating in Python code<a class="headerlink" href="#translating-in-python-code" title="Permalink to this headline">¶</a></h2>
<p>To translate in Python code, use the <a class="reference internal" href="#bottle_utils.i18n.lazy_gettext" title="bottle_utils.i18n.lazy_gettext"><code class="xref py py-func docutils literal"><span class="pre">lazy_gettext()</span></code></a>
and <a class="reference internal" href="#bottle_utils.i18n.lazy_ngettext" title="bottle_utils.i18n.lazy_ngettext"><code class="xref py py-func docutils literal"><span class="pre">lazy_ngettext()</span></code></a> functions.</p>
<p><code class="docutils literal"><span class="pre">lazy_gettext()</span></code> is usually imported as <code class="docutils literal"><span class="pre">_</span></code>, which is a common convention
(alias) for <code class="docutils literal"><span class="pre">gettext()</span></code>. <code class="docutils literal"><span class="pre">lazy_ngettext()</span></code> should be aliased as simply
<code class="docutils literal"><span class="pre">ngettext()</span></code>. Using the lazy versions allows your code to postpone evaluation
of translations until they are actually needed.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">bottle_utils.i18n</span> <span class="kn">import</span> <span class="n">lazy_ngettext</span> <span class="k">as</span> <span class="n">ngettext</span><span class="p">,</span> <span class="n">lazy_gettext</span> <span class="k">as</span> <span class="n">_</span>

<span class="k">def</span> <span class="nf">handler</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">_</span><span class="p">(</span><span class="s">&#39;This is a translatable string&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="translating-in-templates">
<h2>Translating in templates<a class="headerlink" href="#translating-in-templates" title="Permalink to this headline">¶</a></h2>
<p>Translating in SimpleTemplate template code is very similar to translating in
Python code except that all the aliasess have already been set up. Just wrap
the translations in the usual <code class="docutils literal"><span class="pre">{{</span> <span class="pre">}}</span></code> tags.:</p>
<div class="highlight-python"><div class="highlight"><pre>&lt;p&gt;{{ _(&#39;Current time&#39;) }}: {{ time }}&lt;/p&gt;
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Thanks to this syntactic similarity you can extract messages from templates
using GNU Gettext command line tools and treating templates as normal Python
code.</p>
</div>
</div>
<div class="section" id="module-bottle_utils.i18n">
<span id="functions"></span><h2>Functions<a class="headerlink" href="#module-bottle_utils.i18n" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-bottle_utils.i18n"></span><dl class="class">
<dt id="bottle_utils.i18n.I18NPlugin">
<em class="property">class </em><code class="descclassname">bottle_utils.i18n.</code><code class="descname">I18NPlugin</code><span class="sig-paren">(</span><em>app</em>, <em>langs</em>, <em>default_locale</em>, <em>locale_dir</em>, <em>domain='messages'</em>, <em>noplugin=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bottle_utils/i18n.html#I18NPlugin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bottle_utils.i18n.I18NPlugin" title="Permalink to this definition">¶</a></dt>
<dd><p>Bottle plugin and WSGI middleware for handling i18n routes.  This class is
a middleware. However, if the <code class="docutils literal"><span class="pre">app</span></code> argument is a <code class="docutils literal"><span class="pre">Bottle</span></code> object
(bottle app), it will also install itself as a plugin.  The plugin follows
the <a class="reference external" href="http://bottlepy.org/docs/0.12/plugindev.html">version 2 API</a> and
implements the <code class="xref py py-meth docutils literal"><span class="pre">apply()</span></code> method which
applies the plugin to all routes. The plugin and middleware parts were
merged into one class because they depend on each other and can&#8217;t really be
used separately.</p>
<p>During initialization, the class will set up references to locales,
directory paths, and build a mapping between locale names and appropriate
gettext translation APIs. The translation APIs are created using the
<code class="docutils literal"><span class="pre">gettext.translation()</span></code> call. This call tries to access matching MO file
in the locale directory, and will emit a warning if such file is not found.
If a MO file does not exist for a given locale, or it is not readable, the
API for that locale will be downgraded to generic <a class="reference external" href="https://docs.python.org/3.4/library/gettext.html">gettext API</a>.</p>
<p>The class will also update the <code class="docutils literal"><span class="pre">bottle.BaseTemplate.defaults</span></code> dict with
translation-related methods so they are always available in templates (at
least those that are rendered using bottle&#8217;s API. The following variables
become available in all templates:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">_</span></code>: alias for <code class="docutils literal"><span class="pre">lazy_gettext</span></code></li>
<li><code class="docutils literal"><span class="pre">gettext</span></code>: alias for <code class="docutils literal"><span class="pre">lazy_gettext</span></code></li>
<li><code class="docutils literal"><span class="pre">ngettext</span></code>: alias for <code class="docutils literal"><span class="pre">lazy_ngettext</span></code></li>
<li><code class="docutils literal"><span class="pre">pgettext</span></code>: alias for <code class="docutils literal"><span class="pre">lazy_pgettext</span></code></li>
<li><code class="docutils literal"><span class="pre">npgettext</span></code>: alias for <code class="docutils literal"><span class="pre">lazy_pngettext</span></code></li>
<li><code class="docutils literal"><span class="pre">i18n_path</span></code></li>
<li><code class="docutils literal"><span class="pre">languages</span></code>: iterable containing available languages as <code class="docutils literal"><span class="pre">(locale,</span>
<span class="pre">name)</span></code> tuples</li>
</ul>
<p>The middleware itself derives the desired locale from the URL. It does not
read cookies or headers. It only looks for the <code class="docutils literal"><span class="pre">/ll_cc/</span></code> prefix where
<code class="docutils literal"><span class="pre">ll</span></code> is the two-ltter language ID, and <code class="docutils literal"><span class="pre">cc</span></code> is country code. If it
finds such a prefix, it will set the locale in the envionment dict
(<code class="docutils literal"><span class="pre">LOCALE</span></code> key) and fix the path so it doesn&#8217;t include the prefix. This
allows the bottle app to have routes matching any number of locales. If it
doesn&#8217;t find the prefix, it will redirect to the default locale.</p>
<p>If there is no appropriate locale, and <code class="docutils literal"><span class="pre">LOCALE</span></code> key is therfore set to
<code class="docutils literal"><span class="pre">None</span></code>, the plugin will automatically respond with a 302 redirect to a
location of the default locale.</p>
<p>The plugin reads the <code class="docutils literal"><span class="pre">LOCALE</span></code> key set by the middleware, and aliases the
API for that locale as <code class="docutils literal"><span class="pre">request.gettext</span></code>. It also sets <code class="docutils literal"><span class="pre">request.locale</span></code>
attribute to the selected locale. These attributes are used by the
<code class="docutils literal"><span class="pre">lazy_gettext</span></code> and <code class="docutils literal"><span class="pre">lazy_ngettext</span></code>, as well as <code class="docutils literal"><span class="pre">i18n_path</span></code> functions.</p>
<p>The plugin installation during initialization can be competely suppressed,
if you wish (e.g., you wish to apply the plugin yourself some other way).</p>
<p>The locale directory should be in a format which <code class="docutils literal"><span class="pre">gettext.translations()</span></code>
understands. This is a path that contains a subtree matching this format:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">locale_dir</span><span class="o">/</span><span class="n">LANG</span><span class="o">/</span><span class="n">LC_MESSAGES</span><span class="o">/</span><span class="n">DOMAIN</span><span class="o">.</span><span class="n">mo</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">LANG</span></code> should match any of the supported languages, and <code class="docutils literal"><span class="pre">DOMAIN</span></code>
should match the specified domain.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>app</strong> &#8211; <code class="docutils literal"><span class="pre">Bottle</span></code> object</li>
<li><strong>langs</strong> &#8211; iterable containing languages as <code class="docutils literal"><span class="pre">(locale,</span>
<span class="pre">name)</span></code> tuples</li>
<li><strong>default_locale</strong> &#8211; default locale</li>
<li><strong>locale_dir</strong> &#8211; directory containing translations</li>
<li><strong>domain</strong> &#8211; the gettext domain</li>
<li><strong>noplugin</strong> &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="bottle_utils.i18n.I18NPlugin.api">
<code class="descname">api</code><em class="property"> = 2</em><a class="headerlink" href="#bottle_utils.i18n.I18NPlugin.api" title="Permalink to this definition">¶</a></dt>
<dd><p>Bottle plugin API version</p>
</dd></dl>

<dl class="attribute">
<dt id="bottle_utils.i18n.I18NPlugin.app">
<code class="descname">app</code><em class="property"> = None</em><a class="headerlink" href="#bottle_utils.i18n.I18NPlugin.app" title="Permalink to this definition">¶</a></dt>
<dd><p>The original bottle application object is accessible as <code class="docutils literal"><span class="pre">app</span></code>
attribute after initialization.</p>
</dd></dl>

<dl class="attribute">
<dt id="bottle_utils.i18n.I18NPlugin.default_locale">
<code class="descname">default_locale</code><em class="property"> = None</em><a class="headerlink" href="#bottle_utils.i18n.I18NPlugin.default_locale" title="Permalink to this definition">¶</a></dt>
<dd><p>Default locale.</p>
</dd></dl>

<dl class="attribute">
<dt id="bottle_utils.i18n.I18NPlugin.domain">
<code class="descname">domain</code><em class="property"> = None</em><a class="headerlink" href="#bottle_utils.i18n.I18NPlugin.domain" title="Permalink to this definition">¶</a></dt>
<dd><p>Domain of the translation.</p>
</dd></dl>

<dl class="attribute">
<dt id="bottle_utils.i18n.I18NPlugin.gettext_apis">
<code class="descname">gettext_apis</code><em class="property"> = None</em><a class="headerlink" href="#bottle_utils.i18n.I18NPlugin.gettext_apis" title="Permalink to this definition">¶</a></dt>
<dd><p>A dictionary that maps locales to <code class="docutils literal"><span class="pre">gettext.translation()</span></code> objects
for each locale. Appropriate API object is selected from each</p>
</dd></dl>

<dl class="attribute">
<dt id="bottle_utils.i18n.I18NPlugin.langs">
<code class="descname">langs</code><em class="property"> = None</em><a class="headerlink" href="#bottle_utils.i18n.I18NPlugin.langs" title="Permalink to this definition">¶</a></dt>
<dd><p>Supported languages as iterable of <cite>(locale, native_name)</cite> tuples.</p>
</dd></dl>

<dl class="attribute">
<dt id="bottle_utils.i18n.I18NPlugin.locale_dir">
<code class="descname">locale_dir</code><em class="property"> = None</em><a class="headerlink" href="#bottle_utils.i18n.I18NPlugin.locale_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Directory that stores <code class="docutils literal"><span class="pre">.po</span></code> and <code class="docutils literal"><span class="pre">.mo</span></code> files.</p>
</dd></dl>

<dl class="attribute">
<dt id="bottle_utils.i18n.I18NPlugin.locales">
<code class="descname">locales</code><em class="property"> = None</em><a class="headerlink" href="#bottle_utils.i18n.I18NPlugin.locales" title="Permalink to this definition">¶</a></dt>
<dd><p>Supported locales (calculated based on <code class="docutils literal"><span class="pre">langs</span></code> iterable).</p>
</dd></dl>

<dl class="method">
<dt id="bottle_utils.i18n.I18NPlugin.match_locale">
<code class="descname">match_locale</code><span class="sig-paren">(</span><em>path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bottle_utils/i18n.html#I18NPlugin.match_locale"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bottle_utils.i18n.I18NPlugin.match_locale" title="Permalink to this definition">¶</a></dt>
<dd><p>Matches the locale based on prefix in request path. You can customize
this method for a different way of obtaining locale information. Note
that <code class="docutils literal"><span class="pre">None</span></code> return value generally means &#8216;use default&#8217;.</p>
<p>The return value of this method is stored in the environment dictionary
as <code class="docutils literal"><span class="pre">LOCALE</span></code> key. It is then used by the plugin part of this class to
provide translation methods to the rest of the app.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>path</strong> &#8211; request path</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">locale or None</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="bottle_utils.i18n.I18NPlugin.name">
<code class="descname">name</code><em class="property"> = 'i18n'</em><a class="headerlink" href="#bottle_utils.i18n.I18NPlugin.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Bottle plugin name</p>
</dd></dl>

<dl class="staticmethod">
<dt id="bottle_utils.i18n.I18NPlugin.strip_prefix">
<em class="property">static </em><code class="descname">strip_prefix</code><span class="sig-paren">(</span><em>path</em>, <em>locale</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bottle_utils/i18n.html#I18NPlugin.strip_prefix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bottle_utils.i18n.I18NPlugin.strip_prefix" title="Permalink to this definition">¶</a></dt>
<dd><p>Strips the locale prefix from the path. This static method is used to
recalculate the request path that should be passed to Bottle. The
return value of this method replaces the <code class="docutils literal"><span class="pre">PATH_INFO</span></code> key in the
environment dictionary, and the original path is saved in
<code class="docutils literal"><span class="pre">ORIGINAL_PATH</span></code> key.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> &#8211; request path</li>
<li><strong>locale</strong> &#8211; selected locale</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">request path without the locale prefix</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="bottle_utils.i18n.dummy_gettext">
<code class="descclassname">bottle_utils.i18n.</code><code class="descname">dummy_gettext</code><span class="sig-paren">(</span><em>message</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bottle_utils/i18n.html#dummy_gettext"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bottle_utils.i18n.dummy_gettext" title="Permalink to this definition">¶</a></dt>
<dd><p>Mimic <code class="docutils literal"><span class="pre">gettext()</span></code> function. This is a passthrough function with the same
signature as <code class="docutils literal"><span class="pre">gettext()</span></code>. It can be used to simulate translation for
applications that are untranslated, without the overhead of calling the
real <code class="docutils literal"><span class="pre">gettext()</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>message</strong> &#8211; message string</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">unmodified input</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="bottle_utils.i18n.dummy_ngettext">
<code class="descclassname">bottle_utils.i18n.</code><code class="descname">dummy_ngettext</code><span class="sig-paren">(</span><em>singular</em>, <em>plural</em>, <em>n</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bottle_utils/i18n.html#dummy_ngettext"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bottle_utils.i18n.dummy_ngettext" title="Permalink to this definition">¶</a></dt>
<dd><p>Mimic <code class="docutils literal"><span class="pre">ngettext()</span></code> function. This is a passthrough function with the
same signature as <code class="docutils literal"><span class="pre">ngettext()</span></code>. It can be used to simulate translation
for applications that are untranslated, without the overhead of calling the
real <code class="docutils literal"><span class="pre">ngettext()</span></code>.</p>
<p>This function returns the verbatim singular message if <code class="docutils literal"><span class="pre">n</span></code> is 1,
otherwise the verbatim plural message.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>singular</strong> &#8211; singular message string</li>
<li><strong>plural</strong> &#8211; plural message string</li>
<li><strong>n</strong> &#8211; count</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">unmodified singular or plural message</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="bottle_utils.i18n.dummy_npgettext">
<code class="descclassname">bottle_utils.i18n.</code><code class="descname">dummy_npgettext</code><span class="sig-paren">(</span><em>context</em>, <em>singular</em>, <em>plural</em>, <em>n</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bottle_utils/i18n.html#dummy_npgettext"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bottle_utils.i18n.dummy_npgettext" title="Permalink to this definition">¶</a></dt>
<dd><p>Mimic <code class="docutils literal"><span class="pre">npgettext()</span></code> function. This is a passthrough function with teh
same signature as <code class="docutils literal"><span class="pre">npgettext()</span></code>. It can be used to simulate translation
for applications that are untranslated, without the overhead of calling the
real <code class="docutils literal"><span class="pre">npgettext()</span></code> function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>singular</strong> &#8211; singular message string</li>
<li><strong>plural</strong> &#8211; plural message string</li>
<li><strong>n</strong> &#8211; count</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">unmodified singular or plural message</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="bottle_utils.i18n.dummy_pgettext">
<code class="descclassname">bottle_utils.i18n.</code><code class="descname">dummy_pgettext</code><span class="sig-paren">(</span><em>context</em>, <em>message</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bottle_utils/i18n.html#dummy_pgettext"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bottle_utils.i18n.dummy_pgettext" title="Permalink to this definition">¶</a></dt>
<dd><p>Mimic <code class="docutils literal"><span class="pre">pgettext()</span></code> function. This is a passthrough function with the same
signature as <code class="docutils literal"><span class="pre">pgettext()</span></code>. It can be used to simulate translation for
applications that are untranslated, without the overhead of calling the
real <a href="#id1"><span class="problematic" id="id2">``</span></a>pgettext()`.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>context</strong> &#8211; message context (ignored)</li>
<li><strong>message</strong> &#8211; translatable message</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">unmodified message</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="bottle_utils.i18n.full_path">
<code class="descclassname">bottle_utils.i18n.</code><code class="descname">full_path</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bottle_utils/i18n.html#full_path"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bottle_utils.i18n.full_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate full path including query string for current request. This is a
helper function used by <a class="reference internal" href="#bottle_utils.i18n.i18n_path" title="bottle_utils.i18n.i18n_path"><code class="xref py py-func docutils literal"><span class="pre">i18n_path()</span></code></a>. It uses
the current request context to obtain information about the path.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">path with query string</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="bottle_utils.i18n.i18n_path">
<code class="descclassname">bottle_utils.i18n.</code><code class="descname">i18n_path</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bottle_utils/i18n.html#i18n_path"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bottle_utils.i18n.i18n_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Return current request path or specified path for given or current locale.
This function can be used to obtain paths for different locales.</p>
<p>If no <code class="docutils literal"><span class="pre">path</span></code> argument is passed, the
<a class="reference internal" href="#bottle_utils.i18n.full_path" title="bottle_utils.i18n.full_path"><code class="xref py py-func docutils literal"><span class="pre">full_path()</span></code></a> is called to obtain the full path
for current request.</p>
<p>If <code class="docutils literal"><span class="pre">locale</span></code> argument is omitted, current locale is used.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> &#8211; request path</li>
<li><strong>locale</strong> &#8211; locale</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">locale-prefixed path</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="bottle_utils.i18n.i18n_url">
<code class="descclassname">bottle_utils.i18n.</code><code class="descname">i18n_url</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bottle_utils/i18n.html#i18n_url"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bottle_utils.i18n.i18n_url" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a named route in localized form</p>
<p>This function is a light wrapper around Bottle&#8217;s <code class="docutils literal"><span class="pre">get_url()</span></code> function. It
passes the result to <a class="reference internal" href="#bottle_utils.i18n.i18n_path" title="bottle_utils.i18n.i18n_path"><code class="xref py py-func docutils literal"><span class="pre">i18n_path()</span></code></a>.</p>
<p>If <code class="docutils literal"><span class="pre">locale</span></code> keyword argument is passed, it will be used instead of the
currently selected locale.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>route</strong> &#8211; name of the route</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">localized path for the specified route</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="bottle_utils.i18n.i18n_view">
<code class="descclassname">bottle_utils.i18n.</code><code class="descname">i18n_view</code><span class="sig-paren">(</span><em>tpl_base_name=None</em>, <em>**defaults</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bottle_utils/i18n.html#i18n_view"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bottle_utils.i18n.i18n_view" title="Permalink to this definition">¶</a></dt>
<dd><p>Renders a template with locale name as suffix. Unlike the normal view
decorator, the template name should not have an extension. The locale names
are appended to the base template name using underscore (&#8216;_&#8217;) as separator,
and lower-case locale identifier.</p>
<p>Any additional keyword arguments are used as default template variables.</p>
<p>For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@i18n_view</span><span class="p">(</span><span class="s">&#39;foo&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">render_foo</span><span class="p">():</span>
    <span class="c"># Renders &#39;foo_en&#39; for English locale, &#39;foo_fr&#39; for French, etc.</span>
    <span class="k">return</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>tpl_base_name</strong> &#8211; base template name</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="bottle_utils.i18n.lazy_gettext">
<code class="descclassname">bottle_utils.i18n.</code><code class="descname">lazy_gettext</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bottle_utils/i18n.html#lazy_gettext"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bottle_utils.i18n.lazy_gettext" title="Permalink to this definition">¶</a></dt>
<dd><p>Lazily evaluated version of <code class="docutils literal"><span class="pre">gettext()</span></code>.</p>
<p>This function uses the appropriate Gettext API object based on the value of
<code class="docutils literal"><span class="pre">bottle.request.gettext</span></code> set by the plugin. It will fail with
<code class="docutils literal"><span class="pre">AttributeError</span></code> exception if the plugin is not installed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>message</strong> &#8211; translatable message</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">lazy proxy object</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="bottle_utils.i18n.lazy_ngettext">
<code class="descclassname">bottle_utils.i18n.</code><code class="descname">lazy_ngettext</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bottle_utils/i18n.html#lazy_ngettext"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bottle_utils.i18n.lazy_ngettext" title="Permalink to this definition">¶</a></dt>
<dd><p>Lazily evaluated version of <code class="docutils literal"><span class="pre">ngettext()</span></code>.</p>
<p>This function uses the appropriate Gettext API object based on the value of
<code class="docutils literal"><span class="pre">bottle.request.gettext</span></code> set by the plugin. It will fail with
<code class="docutils literal"><span class="pre">AttributeError</span></code> exception if the plugin is not installed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>singular</strong> &#8211; translatable singular message</li>
<li><strong>plural</strong> &#8211; translatable plural message</li>
<li><strong>n</strong> &#8211; count</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">lazy proxy object</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="bottle_utils.i18n.lazy_npgettext">
<code class="descclassname">bottle_utils.i18n.</code><code class="descname">lazy_npgettext</code><span class="sig-paren">(</span><em>context</em>, <em>singular</em>, <em>plural</em>, <em>n</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bottle_utils/i18n.html#lazy_npgettext"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bottle_utils.i18n.lazy_npgettext" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#bottle_utils.i18n.lazy_ngettext" title="bottle_utils.i18n.lazy_ngettext"><code class="xref py py-func docutils literal"><span class="pre">bottle_utils.i18n.lazy_ngettext()</span></code></a> wrapper with message context.</p>
<p>This function is a wrapper around
<a class="reference internal" href="#bottle_utils.i18n.lazy_ngettext" title="bottle_utils.i18n.lazy_ngettext"><code class="xref py py-func docutils literal"><span class="pre">bottle_utils.i18n.lazy_ngettext()</span></code></a>
that provides message context. It is useful in situations where messages
are used in several different contexts for which separate translations may
be required for different languages.</p>
<p>The function itself is not lazy, but it returns the return value of
<code class="docutils literal"><span class="pre">lazy_ngettext()</span></code>, and it is effectively lazy. Hence the name.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>context</strong> &#8211; message context</li>
<li><strong>singular</strong> &#8211; translatable singular message</li>
<li><strong>plural</strong> &#8211; translatable plural message</li>
<li><strong>n</strong> &#8211; count</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">lazy proxy object</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="bottle_utils.i18n.lazy_pgettext">
<code class="descclassname">bottle_utils.i18n.</code><code class="descname">lazy_pgettext</code><span class="sig-paren">(</span><em>context</em>, <em>message</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bottle_utils/i18n.html#lazy_pgettext"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bottle_utils.i18n.lazy_pgettext" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#bottle_utils.i18n.lazy_gettext" title="bottle_utils.i18n.lazy_gettext"><code class="xref py py-func docutils literal"><span class="pre">bottle_utils.i18n.lazy_gettext()</span></code></a> wrapper with message context.</p>
<p>This function is a wrapper around <a class="reference internal" href="#bottle_utils.i18n.lazy_gettext" title="bottle_utils.i18n.lazy_gettext"><code class="xref py py-func docutils literal"><span class="pre">bottle_utils.i18n.lazy_gettext()</span></code></a>
that provides message context. It is useful in situations where short
messages (usually one word) are used in several different contexts for
which separate translations may be needed in different languages.</p>
<p>The function itself is not lazily evaluated, but its return value comes
from <code class="docutils literal"><span class="pre">lazy_gettext()</span></code> call, and it is effectively lazy as a result.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>context</strong> &#8211; message context</li>
<li><strong>message</strong> &#8211; translatable message</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">lazy proxy object</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Translation support (<code class="docutils literal"><span class="pre">bottle_utils.i18n</span></code>)</a><ul>
<li><a class="reference internal" href="#basic-concept">Basic concept</a></li>
<li><a class="reference internal" href="#setting-up-the-app-for-translation">Setting up the app for translation</a></li>
<li><a class="reference internal" href="#translating-in-python-code">Translating in Python code</a></li>
<li><a class="reference internal" href="#translating-in-templates">Translating in templates</a></li>
<li><a class="reference internal" href="#module-bottle_utils.i18n">Functions</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="http.html"
                        title="previous chapter">HTTP helpers (<code class="docutils literal"><span class="pre">bottle_utils.http</span></code>)</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="lazy.html"
                        title="next chapter">Lazy evaluation (<code class="docutils literal"><span class="pre">bottle_utils.lazy</span></code>)</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/i18n.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="lazy.html" title="Lazy evaluation (bottle_utils.lazy)"
             >next</a> |</li>
        <li class="right" >
          <a href="http.html" title="HTTP helpers (bottle_utils.http)"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Bottle Utils 0.1a4 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2014, Outernet Inc &lt;hello@outernet.is&gt;.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>